from typing import List

class Solution:
    def maximumValue(self, n: int, restrictions: List[List[int]], diff: List[int]) -> int:
        # 1. 初始化数组，默认值为无穷大
        ans = [float('inf')] * n
        
        # 2. 设置初始条件和特定位置的限制
        ans[0] = 0
        for idx, maxVal in restrictions:
            ans[idx] = min(ans[idx], maxVal)
            
        # 3. 正向遍历 (Forward Pass)
        # 确保 ans[i+1] <= ans[i] + diff[i]
        # 这一步将 0 和左侧的限制向右传播
        for i in range(n - 1):
            ans[i + 1] = min(ans[i + 1], ans[i] + diff[i])
            
        # 4. 反向遍历 (Backward Pass)
        # 确保 ans[i] <= ans[i+1] + diff[i]
        # 这一步将右侧的限制向左传播，修正之前可能过高的值
        for i in range(n - 2, -1, -1):
            ans[i] = min(ans[i], ans[i + 1] + diff[i])
            
        # 5. 返回最大值
        return max(ans)


我是否可以构造这样一个物理模型，数组的位置就是等间隔排列的竖直杠子，每个杠子上套了3个环，中间的环就是数组的取值，中间的环分别与“上下”两个环通过柔性的绳子连接，绳子长度就是diff的限制，“上下”两个环分别通过刚性的横杠与左右竖直杠子上的套环连接，maxval就是对应位置最大允许的高度



你的直觉非常敏锐！你提出的物理模型核心思想——**“用绳子的长度来限制高度差”**——完全抓住了这个问题的本质。

不过，你描述的“3个环+刚性横杠”的结构稍微复杂了一点，实际上我们可以把你这个模型**简化**一下，让它更符合数学逻辑，也更直观：

### 优化后的物理模型：单环+绳索模型

想象一个二维平面：

1. **竖直杆子（下标）**：
地面上每隔 1 米插一根竖直的光滑杆子，分别代表下标 。
2. **套环（数组值）**：
每根杆子上只套 **1 个环**，这个环的高度就是 。
3. **绳子（diff 限制）**：
这是关键。我们在相邻杆子的套环之间连一根**不可伸长的软绳**。
连接杆子  和杆子  的绳子长度，正是 **`diff[i]`**。
* **物理意义**：根据勾股定理或简单的距离限制（忽略水平间距，只看竖直分量），如果绳子拉直了，两个环的高度差  最大只能等于绳长 `diff[i]`。这就完美对应了题目中的条件。


4. **天花板/地钉（Restrictions & Initial Condition）**：
* ****：第 0 根杆子上的环被钉死在地面上。
* **Restrictions**：对于限制 `[idx, maxVal]`，相当于在第 `idx` 根杆子的高度 `maxVal` 处装了一个**挡板（天花板）**，环不能升到这个高度以上。


5. **向上拉力（最大化目标）**：
题目要求“最大化最大值”。想象我们在每个环上都系一个**氦气球**，或者从下方吹一股强风，试图把所有环都**尽可能向上吹起**。

### 这个模型如何解释算法？

当气球把环向上拉起时，环的高度会被以下两个因素“拽住”：

1. **被挡板挡住**：某些位置碰到了 `maxVal` 的天花板。
2. **被邻居拽住（绳子绷紧）**：
* 如果  想要飞得很高，但  被钉在低处，那么连接它们的绳子（长度 `diff[i-1]`）就会绷紧， 最多只能比  高出绳子的长度。



**这与我们的两次扫描算法完美对应：**

* **从左向右扫描**：模拟的是左边的邻居通过绳子把右边的环“拉住”的过程（或者说，左边的地钉限制通过绳子传递到右边）。
* **从右向左扫描**：模拟的是右边的邻居（可能被某个低的天花板挡住了）通过绳子把左边的环“拉下来”的过程。

### 总结

你的模型中“绳长=diff”是**完全正确**的物理直觉。这就是算法领域中经典的**“差分约束系统”（Difference Constraints）**的物理形态。

在这个模型下，最终形成的形状就像是一个**被多根绳子和钉子拉扯住的帐篷顶**，每一个点都处于它所能达到的最高位置（即绳子绷紧或碰到天花板的状态）。